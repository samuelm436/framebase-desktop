<Window x:Class="framebase_app.LiveMonitorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Framebase â€“ Monitor" Height="650" Width="900" Background="{StaticResource Brush.SurfaceDark}" WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize" Icon="framebase_logo.ico">
    <Grid x:Name="RootGrid" Margin="12">
        <!-- Background layer (will be blurred) -->
        <Grid x:Name="BackgroundLayer">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header with Logo and Account icon -->
            <Border Background="{StaticResource Brush.HeaderGradient}" CornerRadius="12" Padding="12">
                <DockPanel>
                    <!-- Logo and Title -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Image Source="framebase_logo.ico" Width="32" Height="32" VerticalAlignment="Center" Margin="0,0,12,0"/>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Framebase" FontSize="18" FontWeight="Bold" Foreground="White"/>
                            <TextBlock Text="Live-Monitor" FontSize="12" Foreground="#E5E7EB" Margin="0,-2,0,0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Header Actions: overlay and account icons -->
                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" VerticalAlignment="Center" Margin="20,0,0,0" HorizontalAlignment="Right">
                        <Button x:Name="OpenOverlaySettingsButton" Style="{StaticResource HeaderIconButton}" ToolTip="Overlay Einstellungen" HorizontalAlignment="Right" Margin="0,0,8,0">
                            <Border Background="#33FFFFFF" CornerRadius="8" Padding="10,8">
                                <TextBlock Text="ðŸ‘ï¸" FontSize="16" Foreground="White"/>
                            </Border>
                        </Button>
                        <Button x:Name="OpenAccountButton" Style="{StaticResource HeaderIconButton}" ToolTip="Konto verwalten" HorizontalAlignment="Right">
                            <Border Background="#33FFFFFF" CornerRadius="8" Padding="10,8">
                                <TextBlock Text="ðŸ‘¤" FontSize="16" Foreground="White"/>
                            </Border>
                        </Button>
                    </StackPanel>
                </DockPanel>
            </Border>

            <!-- Content area -->
            <Grid Grid.Row="1" Margin="0,12,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Live Metrics -->
                <Border Style="{StaticResource Card}" Grid.Row="0">
                    <StackPanel>
                        <TextBlock Text="Live Metrics" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource Brush.Text}"/>
                        <UniformGrid Columns="3" Margin="0,12,0,0">
                            <StackPanel Margin="0,0,8,0">
                                <TextBlock Text="FPS" Foreground="{StaticResource Brush.TextMuted}" FontSize="12"/>
                                <TextBlock x:Name="FpsText" Text="-" FontSize="32" FontWeight="Bold" Foreground="{StaticResource Brush.Text}" Margin="0,4,0,0"/>
                            </StackPanel>
                            <StackPanel Margin="8,0,8,0">
                                <TextBlock Text="Frametime (ms)" Foreground="{StaticResource Brush.TextMuted}" FontSize="12"/>
                                <TextBlock x:Name="FrametimeText" Text="-" FontSize="32" FontWeight="Bold" Foreground="{StaticResource Brush.Text}" Margin="0,4,0,0"/>
                            </StackPanel>
                            <StackPanel Margin="8,0,0,0">
                                <TextBlock Text="1% Low" Foreground="{StaticResource Brush.TextMuted}" FontSize="12"/>
                                <TextBlock x:Name="Low1Text" Text="-" FontSize="32" FontWeight="Bold" Foreground="{StaticResource Brush.Text}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </UniformGrid>

                        <!-- Status and Session Info in symmetric layout -->
                        <Grid Margin="0,12,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="16" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="16" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- Activity status -->
                            <Border Grid.Column="0" CornerRadius="8" Padding="12" Background="#22343A" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1">
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <Ellipse x:Name="InactivityDot" Width="12" Height="12" Fill="Gray" Margin="0,0,8,0"/>
                                    <TextBlock x:Name="InactivityStatusText" Text="Status unknown" Foreground="{StaticResource Brush.Text}" VerticalAlignment="Center" FontSize="12"/>
                                </StackPanel>
                            </Border>

                            <!-- Session duration -->
                            <Border Grid.Column="2" CornerRadius="8" Padding="12" Background="#22343A" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1">
                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Text="Session Duration" Foreground="{StaticResource Brush.TextMuted}" FontSize="10" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="SessionDurationText" Text="â€”" Foreground="{StaticResource Brush.Text}" FontSize="14" FontWeight="SemiBold" HorizontalAlignment="Center" Margin="0,2,0,0"/>
                                </StackPanel>
                            </Border>

                            <!-- Last session summary -->
                            <Border Grid.Column="4" CornerRadius="8" Padding="12" Background="#22343A" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1">
                                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                    <TextBlock Text="Last Measurement" Foreground="{StaticResource Brush.TextMuted}" FontSize="10" HorizontalAlignment="Center"/>
                                    <TextBlock x:Name="LastSessionSummary" Text="â€”" Foreground="{StaticResource Brush.Text}" FontSize="11" TextWrapping="Wrap" HorizontalAlignment="Center" TextAlignment="Center" Margin="0,2,0,0"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- System Specifications and Game Info -->
                <Grid Grid.Row="1" Margin="0,12,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1.6*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Left: System Specifications -->
                    <Border Grid.Column="0" Style="{StaticResource Card}">
                        <StackPanel>
                            <TextBlock Text="System Specifications" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource Brush.Text}" Margin="0,0,0,16"/>
                            <StackPanel x:Name="SpecsStackPanel" Orientation="Vertical">
                                <!-- Specs will be populated vertically from code-behind -->
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    
                    <!-- Right: Current Game -->
                    <Border Grid.Column="2" Style="{StaticResource Card}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Game Section Title -->
                            <TextBlock Grid.Row="0" Text="Current Game" FontSize="16" FontWeight="SemiBold" Foreground="{StaticResource Brush.Text}" Margin="0,0,0,16"/>
                            
                            <!-- Game Logo and Name -->
                            <Grid Grid.Row="1" VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <Border Grid.Column="0" Background="#1F2937" CornerRadius="12" Padding="12" Margin="0,0,12,0" VerticalAlignment="Center">
                                    <Grid Width="56" Height="56">
                                        <Image x:Name="CurrentGameImage" Width="56" Height="56" Stretch="Uniform" Visibility="Collapsed"/>
                                        <TextBlock x:Name="GamePlaceholder" Text="ðŸŽ®" FontSize="32" HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="#9CA3AF"/>
                                    </Grid>
                                </Border>
                                
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock x:Name="CurrentGameText" Text="No game detected" Foreground="{StaticResource Brush.TextMuted}" FontSize="15" FontWeight="SemiBold" TextWrapping="Wrap" Margin="0,0,0,4"/>
                                    <TextBlock Text="Ready for recording" Foreground="{StaticResource Brush.TextMuted}" FontSize="11" Opacity="0.7"/>
                                </StackPanel>
                            </Grid>
                            
                            <!-- Action Buttons -->
                            <StackPanel Grid.Row="2" Margin="0,16,0,0">
                                <Button x:Name="StopAndUploadButton" Style="{StaticResource PrimaryButton}" Content="Stop &amp; Upload" FontSize="15" Padding="16" MinHeight="48" HorizontalAlignment="Stretch" IsEnabled="False" Margin="0,0,0,8"/>
                                <Button x:Name="OpenAllGamesButton" Style="{StaticResource SecondaryButton}" Content="All Games" FontSize="15" Padding="16" MinHeight="48" HorizontalAlignment="Stretch"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>

                <!-- Bottom spacer removed -->
            </Grid>
        </Grid>

        <!-- Overlay Settings Modal -->
        <Grid x:Name="OverlaySettingsOverlay" Visibility="Collapsed" Background="#80000000">
            <Border Width="400" Height="450" Background="{StaticResource Brush.Surface}" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="12" Padding="20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <DockPanel Margin="0,0,0,16">
                        <Button x:Name="CloseOverlaySettingsButton" DockPanel.Dock="Right" Content="âœ•" Style="{StaticResource CloseButton}" HorizontalAlignment="Right"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="ðŸ‘ï¸" FontSize="20" Margin="0,0,8,0"/>
                            <TextBlock Text="Overlay Settings" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource Brush.Text}"/>
                        </StackPanel>
                    </DockPanel>
                    
                    <StackPanel Grid.Row="1">
                        <TextBlock Text="Configure the in-game overlay" Foreground="{StaticResource Brush.TextMuted}" Margin="0,0,0,12"/>

                        <!-- Master Toggle -->
                        <DockPanel Margin="0,0,0,12">
                            <TextBlock Text="Enable Overlay" VerticalAlignment="Center" Foreground="{StaticResource Brush.Text}" FontSize="14"/>
                            <CheckBox x:Name="OverlayToggle" HorizontalAlignment="Right" VerticalAlignment="Center" LayoutTransform="{StaticResource Scale15}"/>
                        </DockPanel>

                        <!-- Edit Mode -->
                        <Border Background="#1F2937" CornerRadius="8" Padding="12" Margin="0,0,0,12">
                            <StackPanel>
                                <DockPanel>
                                    <TextBlock Text="Edit Mode" VerticalAlignment="Center" Foreground="{StaticResource Brush.Text}" FontWeight="Medium"/>
                                    <CheckBox x:Name="EditModeToggle" HorizontalAlignment="Right" VerticalAlignment="Center" LayoutTransform="{StaticResource Scale15}"/>
                                </DockPanel>
                                <TextBlock Text="Enable to move, resize, and see background." FontSize="11" Foreground="{StaticResource Brush.TextMuted}" Margin="0,4,0,0" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- Scaling -->
                        <TextBlock Text="Size" Foreground="{StaticResource Brush.Text}" Margin="0,0,0,4"/>
                        <DockPanel Margin="0,0,0,12">
                            <TextBlock x:Name="ScaleValueText" Text="100%" Foreground="{StaticResource Brush.TextMuted}" Width="40" DockPanel.Dock="Right" TextAlignment="Right"/>
                            <Slider x:Name="ScaleSlider" Minimum="0.5" Maximum="2.0" Value="1.0" TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                        </DockPanel>

                        <!-- Visibility Toggles -->
                        <TextBlock Text="Visible Elements" Foreground="{StaticResource Brush.Text}" Margin="0,0,0,4"/>
                        <UniformGrid Columns="2">
                            <CheckBox x:Name="ShowFpsCheck" Content="FPS &amp; Avg" IsChecked="True" Margin="0,0,0,8" Foreground="{StaticResource Brush.Text}"/>
                            <CheckBox x:Name="ShowGraphCheck" Content="Frametime Graph" IsChecked="True" Margin="0,0,0,8" Foreground="{StaticResource Brush.Text}"/>
                            <CheckBox x:Name="ShowHardwareCheck" Content="Hardware Stats" IsChecked="True" Margin="0,0,0,8" Foreground="{StaticResource Brush.Text}"/>
                        </UniformGrid>

                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

        <!-- Overlay: presets as in-window popup -->
        <Grid x:Name="PresetsOverlay" Visibility="Collapsed" Background="#80000000">
            <Border Width="860" Height="580" Background="{StaticResource Brush.Surface}" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="12" Padding="20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <DockPanel Margin="0,0,0,16">
                        <Button x:Name="ClosePresetsOverlayButton" DockPanel.Dock="Right" Content="âœ•" Style="{StaticResource CloseButton}" HorizontalAlignment="Right"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Image Source="framebase_logo.ico" Width="20" Height="20" Margin="0,0,8,0"/>
                            <TextBlock Text="All Games" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource Brush.Text}"/>
                        </StackPanel>
                    </DockPanel>
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Disabled" CanContentScroll="True">
                        <UniformGrid x:Name="OverlayGamesGrid" Rows="2" Columns="3" Margin="0,0,0,0"/>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Account Overlay -->
        <Grid x:Name="AccountOverlay" Visibility="Collapsed" Background="#80000000">
            <Border Width="500" Height="420" Background="{StaticResource Brush.Surface}" BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="12" Padding="20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <DockPanel Margin="0,0,0,16">
                        <Button x:Name="CloseAccountOverlayButton" DockPanel.Dock="Right" Content="âœ•" Style="{StaticResource CloseButton}" HorizontalAlignment="Right"/>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <TextBlock Text="ðŸ‘¤" FontSize="20" Margin="0,0,8,0"/>
                            <TextBlock Text="Account" FontSize="18" FontWeight="SemiBold" Foreground="{StaticResource Brush.Text}"/>
                        </StackPanel>
                    </DockPanel>
                    <StackPanel Grid.Row="1" VerticalAlignment="Top">
                        <Border Style="{StaticResource Card}" Padding="20" Margin="0,0,0,12">
                            <StackPanel HorizontalAlignment="Center">
                                <TextBlock Text="ðŸ‘¤" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,12"/>
                                <TextBlock x:Name="AccountStatusText" Text="Not connected" FontSize="16" FontWeight="Medium" Foreground="{StaticResource Brush.Text}" HorizontalAlignment="Center" Margin="0,0,0,8"/>
                                <TextBlock x:Name="AccountEmailText" Text="" FontSize="14" Foreground="{StaticResource Brush.TextMuted}" HorizontalAlignment="Center"/>
                            </StackPanel>
                        </Border>

                        <!-- Not connected: show reconnect option -->
                        <StackPanel x:Name="NotConnectedPanel" Orientation="Vertical" Margin="0,0,0,12" HorizontalAlignment="Center">
                            <TextBlock Text="This device is not connected to your account" Foreground="{StaticResource Brush.TextMuted}" Margin="0,0,0,8" TextAlignment="Center"/>
                            <Button x:Name="ReconnectButton" Content="Connect Device" Style="{StaticResource PrimaryButton}" Margin="0,8,0,0" Width="160" HorizontalAlignment="Center"/>
                        </StackPanel>

                        <!-- Connected: show unpair button -->
                        <StackPanel x:Name="ConnectedPanel" Orientation="Horizontal" HorizontalAlignment="Center" Visibility="Collapsed">
                            <Button x:Name="UnpairButton" Content="Disconnect" Style="{StaticResource SecondaryButton}" Width="160"/>
                            <Button x:Name="RefreshAccountButton" Content="Refresh" Style="{StaticResource PrimaryButton}" Margin="8,0,0,0" Width="140"/>
                            <Button x:Name="ResetSetupButton" Content="Reset Setup" Style="{StaticResource DangerButton}" Margin="8,0,0,0" Width="140"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>

    </Grid>
</Window>
